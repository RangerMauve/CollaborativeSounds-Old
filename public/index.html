<!DOCTYPE html>
<head>
	<title>Collaborative Sounds</title>
	<script type="text/javascript" src="scripts/jquery.js"></script> 
    
	<link rel="stylesheet" type="text/css" href="stylesheets/index.css"> 
    <script src="/scripts/jquery.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/scripts/Chat.js"></script>
</head>
<body>
	<div	id = "participate">
		<input	type = "button"
				name = "participate"
				value = "paticipate"
				onclick = "	$('#participate').hide();
							$('#loggin').show();"/>
		<input	type = "button"
				name = "listen"
				value = "just listen"
				onclick = " $('#participate').hide();
							$('#chat').show();
							$('#workspace').show()
							$('#spawn').show();;" />
	</div>
	<div	id = "loggin"
			style = "display:none;">
		Username:
		<input	type = "text"
				name = "user"
				id="user"/>
		<br/>
		Room*:
		<input	type = "text"
				name = "room" />
		<br/>
		*optional
		<br/>
		<input	type = "button"
				name = "blogin"
				value = "go"
				onclick = " $('#loggin').hide();
							$('#chat').show();
							$('#workspace').show();
							$('#spawn').show();
							login();" />
	</div>
	<div	id = "chat"
			style = "display:none;">
		<div id = "chatter">
		</div>
		<div id = "typing">
			<input	id="chatinput" type="text"/>
			<button id="chatsubmit">Send</button>
		</div>
	</div>
	<div	id = "workspace"
			style = "display:none;">
	</div>
	<div	id = "spawn"
			style = "display:none;">
				Spawn
				<br />
				<input	type = "button"
						name = "shared"
						value = "shared" />
				<br />
				<input	type = "button"
						name = "oscillator"
						value = "oscillator" />
				<br />
				<input	type = "button"
						name = "gain"
						value = "gain" />
				<br />
				<input	type = "button"
						name = "delay"
						value = "delay" />
				<br />
				<input	type = "button"
						name = "panner"
						value = "panner" />
				<br />
				<input	type = "button"
						name = "convoluter"
						value = "convoluter" />
				<br />
				<input	type = "button"
						name = "passfilter"
						value = "passfilter" />
				<br />
				<input	type = "button"
						name = "wave"
						value = "wave" />
		</div> 
      <script type="text/javascript">  
		var out = document.getElementById("chatter");
		function append(message){
			out.innerHTML+=message;
		}
		function login () {
			var username = document.getElementById("user").value;

			Chat.connect("test", username, function(err,controls){
				if(err)append('<div style="color:#F00">Error:'+err+'</div>');
				
				$("#chatinput").keyup(function(e){
					if(e.which == 13)
						controls.message($("#chatinput").val(),function(err){
							if(err)append('<div style="color:#F00">Error:'+err+'</div>');
							else $("#chatinput").val("");
						});
				});
				
				$("#chatsubmit").click(function(e){
					console.log("Clicked");
					controls.message($("#chatInput").val(),function(err){
						if(err)append('<div style="color:#F00">Error:'+err+'</div>');
						else $("#chatinput").val("");
					});
				});
				
				controls.onmessage= function(name,message){
					append("<div>"+name+": "+message+"</div>");
	                
				}; 
			});
		}
	</script>
</body>
